// Compiled by ClojureScript 0.0-2202
goog.provide('thi.ng.geom.webgl.shaders.spotlight');
goog.require('cljs.core');
thi.ng.geom.webgl.shaders.spotlight.shader_spec = new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"vs","vs",1013908015),"\nvoid main(){\n  vNormal = normal;\n  vWorldPos = model * vec4(position, 1.0);\n  gl_Position = proj * view * vWorldPos;\n}",new cljs.core.Keyword(null,"fs","fs",1013907519),"\nfloat attenuation(vec3 dir){\n  float dist = length(dir);\n  float radiance = 1.0/(1.0+pow(dist/10.0, 2.0));\n  return clamp(radiance*10.0, 0.0, 1.0);\n}\n\nfloat influence(vec3 normal, float coneAngle){\n  float minConeAngle = (360.0-coneAngle-10.0) * RAD;\n  float maxConeAngle = (360.0-coneAngle) * RAD;\n  return smoothstep(minConeAngle, maxConeAngle, acos(normal.z));\n}\n\nfloat lambert(vec3 surfaceNormal, vec3 lightDirNormal){\n  return max(0.0, dot(surfaceNormal, lightDirNormal));\n}\n\nvec3 skyLight(vec3 normal){\n  return vec3(smoothstep(0.0, PI, PI-acos(normal.y)))*0.4;\n}\n\nvec3 gamma(vec3 color){\n  return pow(color, vec3(2.2));\n}\n\nvoid main(){\n  vec3 worldNormal = normalize(vNormal);\n\n  vec3 camPos = (view * vWorldPos).xyz;\n  vec3 lightPos = (lightView * vWorldPos).xyz;\n  vec3 lightPosNormal = normalize(lightPos);\n  vec3 lightSurfaceNormal = lightRot * worldNormal;\n\n  vec3 excident = (\n                   skyLight(worldNormal) +\n                   lambert(lightSurfaceNormal, -lightPosNormal) *\n                   influence(lightPosNormal, coneAngle) *\n                   attenuation(lightPos)\n                   );\n  gl_FragColor = vec4(gamma(excident), 1.0);\n}",new cljs.core.Keyword(null,"uniforms","uniforms",709120177),new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,"view","view",1017523735),new cljs.core.Keyword(null,"mat4","mat4",1017248326),new cljs.core.Keyword(null,"proj","proj",1017353935),new cljs.core.Keyword(null,"mat4","mat4",1017248326),new cljs.core.Keyword(null,"model","model",1117974171),new cljs.core.Keyword(null,"mat4","mat4",1017248326),new cljs.core.Keyword(null,"lightView","lightView",1699634253),new cljs.core.Keyword(null,"mat4","mat4",1017248326),new cljs.core.Keyword(null,"lightRot","lightRot",2005852243),new cljs.core.Keyword(null,"mat3","mat3",1017248325),new cljs.core.Keyword(null,"coneAngle","coneAngle",4439067362),new cljs.core.Keyword(null,"float","float",1111430606)], null),new cljs.core.Keyword(null,"attribs","attribs",4634025563),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"position","position",1761709211),new cljs.core.Keyword(null,"vec3","vec3",1017519761),new cljs.core.Keyword(null,"normal","normal",4269125721),new cljs.core.Keyword(null,"vec3","vec3",1017519761)], null),new cljs.core.Keyword(null,"varying","varying",1251174370),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"vNormal","vNormal",704244847),new cljs.core.Keyword(null,"vec3","vec3",1017519761),new cljs.core.Keyword(null,"vWorldPos","vWorldPos",2583502698),new cljs.core.Keyword(null,"vec4","vec4",1017519762)], null)], null);
